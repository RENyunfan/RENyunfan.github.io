
<!doctype html>














<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/assets/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/assets/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/assets/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Competition," />





  <link rel="alternate" href="/atom.xml" title="Yunfan REN" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?v=5.1.1" />
















<meta name="description" content="Vision-SLAM UAV project">
<meta name="keywords" content="Competition">
<meta property="og:type" content="article">
<meta property="og:title" content="V-SLAM UAV">
<meta property="og:url" content="http://localhost:4000/competition/2019/08/30/Vslam/">
<meta property="og:site_name" content="Yunfan REN">
<meta property="og:description" content="Vision-SLAM UAV project">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://pic.downk.cc/item/5e2351d22fb38b8c3c648ebd.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e2351fc2fb38b8c3c649193.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="V-SLAM UAV">
<meta name="twitter:description" content="Vision-SLAM UAV project">
<meta name="twitter:image" content="https://pic.downk.cc/item/5e2351d22fb38b8c3c648ebd.png">


<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://localhost:4000/"/>





  <title>V-SLAM UAV | Yunfan REN</title>
  
















</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yunfan REN</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

<div id="posts" class="posts-expand">
  
  

  

  
  
  

  <article class="post post-type-photo " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://localhost:4000/competition/2019/08/30/Vslam/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yunfan REN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://pic.downk.cc/item/5e2371802fb38b8c3c674e0a.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yunfan REN">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            V-SLAM UAV
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-30T11:45:20-04:00">
                2019-08-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/category/#/Competition" itemprop="url" rel="index">
                    <span itemprop="name">Competition</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          
            
                <div class="post-description">
                    Vision-SLAM UAV project
                </div>
            
          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
          
          
            
            <div class="post-gallery-row">
              <a class="post-gallery-img fancybox"
                 href="https://pic.downk.cc/item/5e2351d22fb38b8c3c648ebd.png" rel="gallery_"
                 itemscope itemtype="http://schema.org/ImageObject" itemprop="url">
                <img src="https://pic.downk.cc/item/5e2351d22fb38b8c3c648ebd.png" itemprop="contentUrl"/>
              </a>
            
          
            
            
              <a class="post-gallery-img fancybox"
                 href="https://pic.downk.cc/item/5e2351fc2fb38b8c3c649193.jpg" rel="gallery_"
                 itemscope itemtype="http://schema.org/ImageObject" itemprop="url">
                <img src="https://pic.downk.cc/item/5e2351fc2fb38b8c3c649193.jpg" itemprop="contentUrl"/>
              </a>
            
          

          
          
          </div>
        </div>
      

      
        
  
  












  <h1 id="uav-competition-ros-sys">UAV Competition ROS sys</h1>

<blockquote>
  <p>This project is applicable to the 2019 Guangdong-Hong Kong-Macao engineering training competition and drone rescue competition. This project is based on ROS to realize the vision SLAM positioning of the drone, the identification of the wounded, the picking up of items and the fixed-point delivery.</p>
</blockquote>

<p><strong>Project sites</strong>: <a href="https://github.com/RENyunfan/Projets/tree/master/V-SLAM-UAV">Click Here</a></p>

<p><strong>Warning</strong></p>

<ul>
  <li>This project can only be used for specific drones, please <strong>DO NOT</strong> use it directly on your own drones, the author will not be responsible for any consequences. Welcome to communicate with the author, modify some code to make it suitable for your drone.</li>
</ul>

<p><img src="https://pic.downk.cc/item/5e2351d22fb38b8c3c648ebd.png" alt="" /></p>

<p><img src="https://pic.downk.cc/item/5e2351fc2fb38b8c3c649193.jpg" alt="" /></p>

<h1 id="0-how-to-use">0 How to use</h1>

<ul>
  <li>
    <h2 id="clone-the-project">clone the project</h2>

    <p>First time use:</p>

    <p><code class="highlighter-rouge">	sudo chmod 777 ./wtr_launch.sh </code></p>

    <p>Launch the drone:</p>

    <p><code class="highlighter-rouge">./wtr_launch.sh</code></p>
  </li>
  <li>
    <h2 id="remote-screen">Remote screen</h2>

    <ul>
      <li>
        <h4 id="teamviewer">teamviewer</h4>

        <p>https://jingyan.baidu.com/article/63f2362840c1320208ab3dc1.html
ID:1381057908
password:nrsl01</p>
      </li>
      <li>
        <h4 id="windows">Windows</h4>

        <p>https://www.cnblogs.com/edong/p/5262162.html</p>

        <p>Select vnc-any for Module and fill in 127.0.0.1 for ip.</p>
      </li>
    </ul>

    <p><img src="https://pic.downk.cc/item/5e23528e2fb38b8c3c649aef.jpg" alt="" /></p>
  </li>
</ul>

<h1 id="1-rules">1 Rules</h1>

<ul>
  <li>Variables should capitalize the first letter and split with ‘_’</li>
</ul>

<blockquote>
  <p>e.g. :Position_control_success</p>
</blockquote>

<ul>
  <li>Use data structure which has already exist in ROS</li>
</ul>

<div class="language-c++ highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48<br/>49<br/>50<br/>51<br/>52<br/>53<br/>54<br/>55<br/>56<br/>57<br/>58</pre></td><td class="code"><pre class="highlight"><code><span class="cp"># This represents an estimate of a position and velocity in free space.  
# The pose in this message should be specified in the coordinate frame given by header.frame_id.
# The twist in this message should be specified in the coordinate frame given by the child_frame_id
</span><span class="n">Header</span> <span class="n">header</span>
<span class="n">string</span> <span class="n">child_frame_id</span>
<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">PoseWithCovariance</span> <span class="n">pose</span>
<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">TwistWithCovariance</span> <span class="n">twist</span>

<span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
<span class="n">string</span> <span class="n">child_frame_id</span>
<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">PoseWithCovariance</span> <span class="n">pose</span>
<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">TwistWithCovariance</span> <span class="n">twist</span>

<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Point</span> <span class="n">position</span>
<span class="n">float64</span> <span class="n">x</span>
<span class="n">float64</span> <span class="n">y</span>
<span class="n">float64</span> <span class="n">z</span>
<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Quaternion</span> <span class="n">orientation</span>
<span class="n">float64</span> <span class="n">x</span>
<span class="n">float64</span> <span class="n">y</span>
<span class="n">float64</span> <span class="n">z</span>
<span class="n">float64</span> <span class="n">w</span>

<span class="cp"># This represents a vector in free space. 
# It is only meant to represent a direction. Therefore, it does not
# make sense to apply a translation to it (e.g., when applying a 
# generic rigid transformation to a Vector3, tf2 will only apply the
# rotation). If you want your data to be translatable too, use the
# geometry_msgs/Point message instead.
</span><span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span>
<span class="n">float64</span> <span class="n">x</span>
<span class="n">float64</span> <span class="n">y</span>
<span class="n">float64</span> <span class="n">z</span>

<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Transform</span>
<span class="cp"># This represents the transform between two coordinate frames in free space.
</span>
<span class="n">Vector3</span> <span class="n">translation</span>
<span class="cp"># This represents a vector in free space. 
# It is only meant to represent a direction. Therefore, it does not
# make sense to apply a translation to it (e.g., when applying a 
# generic rigid transformation to a Vector3, tf2 will only apply the
# rotation). If you want your data to be translatable too, use the
# geometry_msgs/Point message instead.
</span><span class="n">float64</span> <span class="n">x</span>
<span class="n">float64</span> <span class="n">y</span>
<span class="n">float64</span> <span class="n">z</span>
<span class="n">Quaternion</span> <span class="n">rotation</span>
<span class="cp"># This represents an orientation in free space in quaternion form.
</span><span class="n">float64</span> <span class="n">x</span>
<span class="n">float64</span> <span class="n">y</span>
<span class="n">float64</span> <span class="n">z</span>
<span class="n">float64</span> <span class="n">w</span>

<span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span>
<span class="cp"># This expresses velocity in free space broken into its linear and angular parts.
</span><span class="n">Vector3</span>  <span class="n">linear</span>
<span class="n">Vector3</span>  <span class="n">angular</span>
</code></pre></td></tr></tbody></table></div></div>

<h1 id="2-data-structure">2 Data structure</h1>

<div class="language-c++ highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31</pre></td><td class="code"><pre class="highlight"><code><span class="k">struct</span> <span class="n">PID_t</span><span class="p">{</span>
    <span class="kt">float</span> <span class="n">Kp</span><span class="p">,</span><span class="n">Ki</span><span class="p">,</span><span class="n">Kd</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">cur_error</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">ref</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">output</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">outputMax</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">error</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">enum</span> <span class="n">WTR_function_state</span><span class="p">{</span>
    <span class="n">WTR_faild</span><span class="p">,</span>
    <span class="n">WTR_success</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">workstate_e</span><span class="p">{</span>
    <span class="n">GROUND</span><span class="p">,</span>
    <span class="n">LAND</span><span class="p">,</span>
    <span class="n">P2P_FLYING</span><span class="p">,</span>
    <span class="n">SEARCH</span><span class="p">,</span>
    <span class="n">CATCH</span>
<span class="p">}</span>
<span class="k">struct</span> <span class="n">UAV</span><span class="p">{</span>
    <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">Twist</span> <span class="n">WTR_twist</span><span class="p">;</span>
    <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">Point</span> <span class="n">Target_pose</span><span class="p">,</span><span class="n">Present_pose</span><span class="p">;</span>
    <span class="n">workstate_e</span> <span class="n">Workstate</span><span class="p">;</span>
    <span class="n">PID_t</span> <span class="n">Position_x</span><span class="p">,</span><span class="n">Position_y</span><span class="p">,</span><span class="n">Position_z</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">NOW</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">LAST</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>


</code></pre></td></tr></tbody></table></div></div>

<h1 id="3-p2p-part">3 P2P part</h1>

<div class="language-c++ highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28</pre></td><td class="code"><pre class="highlight"><code>
<span class="cm">/* PID CAL*/</span>

<span class="n">WTR_function_state</span> <span class="nf">Vol_pub</span><span class="p">()</span>
<span class="p">{</span>
    
<span class="p">}</span>

<span class="n">WTR_function_state</span> <span class="nf">Point_2_Point</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Position_x</span><span class="p">.</span><span class="n">cur_error</span> <span class="o">=</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Present_pose</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Target_pose</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
    <span class="n">Position_y</span><span class="p">.</span><span class="n">cur_error</span> <span class="o">=</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Present_pose</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Target_pose</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="n">Position_x</span><span class="p">.</span><span class="n">cur_error</span> <span class="o">=</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Present_pose</span> <span class="o">-</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Target_pose</span><span class="p">;</span>
    <span class="n">PID_Calc</span><span class="p">(</span><span class="n">Position_x</span><span class="p">);</span>
    <span class="n">PID_Calc</span><span class="p">(</span><span class="n">Position_y</span><span class="p">);</span>
<span class="c1">//    PID_Calc(Position_z);
</span><span class="p">}</span>

<span class="kt">void</span> <span class="n">PID_Calc</span><span class="p">(</span><span class="n">PID_t</span> <span class="o">*</span><span class="n">pid</span><span class="p">){</span>
    
    <span class="n">pid</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">+=</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">KP</span> <span class="o">*</span> <span class="p">(</span><span class="n">pid</span><span class="o">-&gt;</span><span class="n">cur_error</span> <span class="o">-</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="o">+</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">KI</span> <span class="o">*</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">cur_error</span> <span class="o">+</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">KD</span> <span class="o">*</span> <span class="p">(</span><span class="n">pid</span><span class="o">-&gt;</span><span class="n">cur_error</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    
    <span class="n">pid</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> 
	<span class="n">pid</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">cur_error</span><span class="p">;</span>
	<span class="cm">/* PID amplitude limitation */</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pid</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">&gt;</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">outputMax</span><span class="p">)</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">outputMax</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pid</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">pid</span><span class="o">-&gt;</span><span class="n">outputMax</span><span class="p">)</span> <span class="n">pid</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="o">-</span><span class="n">pid</span><span class="o">-&gt;</span><span class="n">outputMax</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></tbody></table></div></div>

<h1 id="4-main">4 Main</h1>

<div class="language-c++ highlighter-rouge"><div class="highlight"><table style="margin: 0px"><tbody><tr><td class="gutter"><pre>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>10<br/>11<br/>12<br/>13<br/>14<br/>15<br/>16<br/>17<br/>18<br/>19<br/>20<br/>21<br/>22<br/>23<br/>24<br/>25<br/>26<br/>27<br/>28<br/>29<br/>30<br/>31<br/>32<br/>33<br/>34<br/>35<br/>36<br/>37<br/>38<br/>39<br/>40<br/>41<br/>42<br/>43<br/>44<br/>45<br/>46<br/>47<br/>48<br/>49<br/>50<br/>51<br/>52<br/>53<br/>54<br/>55<br/>56<br/>57<br/>58<br/>59<br/>60<br/>61<br/>62<br/>63<br/>64<br/>65<br/>66<br/>67<br/>68<br/>69<br/>70<br/>71<br/>72<br/>73<br/>74<br/>75<br/>76<br/>77<br/>78<br/>79<br/>80</pre></td><td class="code"><pre class="highlight"><code><span class="cp">#include "ros/ros.h"
#include "geometry_msgs/Odometry"
#include "geometry_msgs/Transform"
#include "geomrtry_msgs/Point" 
#include &lt;sstream&gt;
</span><span class="cm">/**
 * This tutorial demonstrates simple sending of messages over the ROS system.
 */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span> 
   <span class="cm">/**
    * The ros::init() function needs to see argc and argv so that it can perform
    * any ROS arguments and name remapping that were provided at the command line.
    * For programmatic remappings you can use a different version of init() which takes
    * remappings directly, but for most command-line programs, passing argc and rgv is
    * the easiest way to do it.  The third argument to init() is the name of the e.
    *
    * You must call one of the versions of ros::init() before using any other
    * part of the ROS system.
    */</span>
   <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="s">"Master"</span><span class="p">);</span>
 
  <span class="cm">/**
    * NodeHandle is the main access point to communications with the ROS system.
     * The first NodeHandle constructed will fully initialize this node, and the last
     * NodeHandle destructed will close down the node.
     */</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">n</span><span class="p">;</span>
  
    <span class="cm">/**
     * The advertise() function is how you tell ROS that you want to
     * publish on a given topic name. This invokes a call to the ROS
     * master node, which keeps a registry of who is publishing and who
    * is subscribing. After this advertise() call is made, the master
    * node will notify anyone who is trying to subscribe to this topic name,
    * and they will in turn negotiate a peer-to-peer connection with this
     * node.  advertise() returns a Publisher object which allows you to
     * publish messages on that topic through a call to publish().  Once
     * all copies of the returned Publisher object are destroyed, the topic
     * will be automatically unadvertised.
     *
     * The second parameter to advertise() is the size of the message queue
     * used for publishing messages.  If messages are published more quickly
     * than we can send them, the number here specifies how many messages to
     * buffer up before throwing some away.
     */</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span> <span class="n">velocity_pub</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">Transform</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"wtr/transform"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
  
    <span class="n">ros</span><span class="o">::</span><span class="n">Rate</span> <span class="n">loop_rate</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">ros</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
    <span class="p">{</span>
      <span class="cm">/**
       * This is a message object. You stuff it with data, and then publish it.
       */</span>
      <span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span> <span class="n">msg</span><span class="p">;</span>
  
      <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span>
      <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="s">"Velosity pub "</span> <span class="o">&lt;&lt;</span> <span class="n">UAV</span><span class="p">.</span><span class="n">Twist</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
      <span class="n">msg</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
  
      <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
  
      <span class="cm">/**
       * The publish() function is how you send messages. The parameter
       * is the message object. The type of this object must agree with the type
       * given as a template parameter to the advertise&lt;&gt;() call, as was done
       * in the constructor above.
       */</span>
      <span class="n">chatter_pub</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
  
      <span class="n">ros</span><span class="o">::</span><span class="n">spinOnce</span><span class="p">();</span>
  
      <span class="n">loop_rate</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span>
      <span class="o">++</span><span class="n">count</span><span class="p">;</span>
    <span class="p">}</span>
 
  
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></td></tr></tbody></table></div></div>



      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            
            <a href="/tag/#/Competition" rel="tag"># Competition</a>
          
        </div>
      

      
      
      
      
      

      
      
        <div class="post-nav" id="post-nav-id">
          <div class="post-nav-next post-nav-item">
            
              <a href="/project/2019/10/01/cuda-DIP/" rel="next" title="RT DIP with cuda">
                <i class="fa fa-chevron-left"></i> RT DIP with cuda
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/tutorial/2017/07/20/next-tutorial/" rel="prev" title="Kevin">
                Kevin <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      
      

      
    </footer>
  </article>

  <div class="post-spread">
    
  </div>
</div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          

  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        
        
        







      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://pic.downk.cc/item/5e2371802fb38b8c3c674e0a.jpg"
               alt="Yunfan REN" />
          <p class="site-author-name" itemprop="name">Yunfan REN</p>
           
              <p class="site-description motion-element" itemprop="description">Robotic and Automation</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
        
        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            








            
              <div class="post-toc-content">
    <ol class=nav>
      <li class="nav-item nav-level-1"> <a class="nav-link" href="#uav-competition-ros-sys"> <span class="nav-number">1</span> <span class="nav-text">UAV Competition ROS sys</span> </a> </li> <li class="nav-item nav-level-1"> <a class="nav-link" href="#0-how-to-use"> <span class="nav-number">2</span> <span class="nav-text">0 How to use</span> </a> <ol class="nav-child"> <li class="nav-item nav-level-2"> <a class="nav-link" href="#clone-the-project"> <span class="nav-number">2.1</span> <span class="nav-text">clone the project</span> </a> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#remote-screen"> <span class="nav-number">2.2</span> <span class="nav-text">Remote screen</span> </a> <ol class="nav-child"> <li class="nav-item nav-level-4"> <a class="nav-link" href="#teamviewer"> <span class="nav-number">2.2.1</span> <span class="nav-text">teamviewer</span> </a> </li> <li class="nav-item nav-level-4"> <a class="nav-link" href="#windows"> <span class="nav-number">2.2.2</span> <span class="nav-text">Windows</span> </a> </li> </ol> </li> </ol> </li> <li class="nav-item nav-level-1"> <a class="nav-link" href="#1-rules"> <span class="nav-number">3</span> <span class="nav-text">1 Rules</span> </a> </li> <li class="nav-item nav-level-1"> <a class="nav-link" href="#2-data-structure"> <span class="nav-number">4</span> <span class="nav-text">2 Data structure</span> </a> </li> <li class="nav-item nav-level-1"> <a class="nav-link" href="#3-p2p-part"> <span class="nav-number">5</span> <span class="nav-text">3 P2P part</span> </a> </li> <li class="nav-item nav-level-1"> <a class="nav-link" href="#4-main"> <span class="nav-number">6</span> <span class="nav-text">4 Main</span> </a> </li>
    </ol>
  </div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>

        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yunfan REN</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://jekyllrb.com">Jekyll</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/simpleyyt/jekyll-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





















  
   
  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/assets/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/assets/js/src/motion.js?v=5.1.1"></script>



  
  

  <script type="text/javascript" src="/assets/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/assets/js/src/post-details.js?v=5.1.1"></script>


  


  <script type="text/javascript" src="/assets/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  











  




  

    

  







  






  

  

  
  


  

  

  

</body>
</html>

